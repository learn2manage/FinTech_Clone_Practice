import { ExpoRequest, ExpoResponse } from 'expo-router/server';

const API_KEY = process.env.CRYPTO_API_KEY;

export async function GET(request: ExpoRequest) {
  const limit = request.expoUrl.searchParams.get('limit') || 5;

  // Do not perform fetch during development to save quota, use dummy data instead
  /* const response = await fetch(
    `https://pro-api.coinmarketcap.com/v1/cryptocurrency/listings/latest?start=1&limit=${limit}&convert=EUR`,
    {
      headers: {
        'X-CMC_PRO_API_KEY': API_KEY!,
      },
    },
  );

  const res = await response.json(); */
  //return ExpoResponse.json(res.data);
  return ExpoResponse.json(data);
}

const data = [
  {
    id: 1,
    name: 'Bitcoin',
    symbol: 'BTC',
    slug: 'bitcoin',
    num_market_pairs: 11018,
    date_added: '2019-07-21T00:00:00.000Z',
    tags: [
      'mineable',
      'pow',
      'sha-256',
      'store-of-value',
      'state-channel',
      'coinbase-ventures-portfolio',
      'three-arrows-capital-portfolio',
      'polychain-capital-portfolio',
      'binance-labs-portfolio',
      'blockchain-capital-portfolio',
      'boostvc-portfolio',
      'cms-holdings-portfolio',
      'dcg-portfolio',
      'dragonfly-capital-portfolio',
      'electric-capital-portfolio',
      'fabric-ventures-portfolio',
      'framework-ventures-portfolio',
      'galaxy-digital-portfolio',
      'huobi-capital-portfolio',
      'alameda-research-portfolio',
      'a16z-portfolio',
      '1confirmation-portfolio',
      'winklevoss-capital-portfolio',
      'usv-portfolio',
      'placeholder-ventures-portfolio',
      'pantera-capital-portfolio',
      'multicoin-capital-portfolio',
      'paradigm-portfolio',
      'bitcoin-ecosystem',
      'ftx-bankruptcy-estate',
    ],
    max_supply: 21000000,
    circulating_supply: 19689946,
    total_supply: 19689946,
    infinite_supply: false,
    platform: null,
    cmc_rank: 1,
    self_reported_circulating_supply: null,
    self_reported_market_cap: null,
    tvl_ratio: null,
    last_updated: '2024-04-25T07:53:00.000Z',
    quote: {
      EUR: {
        price: 59737.12003367884,
        volume_24h: 29028020893.60505,
        volume_change_24h: 28.169,
        percent_change_1h: -0.34911371,
        percent_change_24h: -4.10720109,
        percent_change_7d: 4.54238417,
        percent_change_30d: -9.5826665,
        percent_change_60d: 23.70383439,
        percent_change_90d: 60.26948258,
        market_cap: 1176220667658.6543,
        market_cap_dominance: 53.4464,
        fully_diluted_market_cap: 1254479520707.2583,
        tvl: null,
        last_updated: '2024-04-25T07:53:03.000Z',
      },
    },
  },
  {
    id: 1027,
    name: 'Ethereum',
    symbol: 'ETH',
    slug: 'ethereum',
    num_market_pairs: 8862,
    date_added: '2015-08-07T00:00:00.000Z',
    tags: [
      'pos',
      'smart-contracts',
      'ethereum-ecosystem',
      'coinbase-ventures-portfolio',
      'three-arrows-capital-portfolio',
      'polychain-capital-portfolio',
      'binance-labs-portfolio',
      'blockchain-capital-portfolio',
      'boostvc-portfolio',
      'cms-holdings-portfolio',
      'dcg-portfolio',
      'dragonfly-capital-portfolio',
      'electric-capital-portfolio',
      'fabric-ventures-portfolio',
      'framework-ventures-portfolio',
      'hashkey-capital-portfolio',
      'kenetic-capital-portfolio',
      'huobi-capital-portfolio',
      'alameda-research-portfolio',
      'a16z-portfolio',
      '1confirmation-portfolio',
      'winklevoss-capital-portfolio',
      'usv-portfolio',
      'placeholder-ventures-portfolio',
      'pantera-capital-portfolio',
      'multicoin-capital-portfolio',
      'paradigm-portfolio',
      'injective-ecosystem',
      'layer-1',
      'ftx-bankruptcy-estate',
    ],
    max_supply: null,
    circulating_supply: 122048136.08993804,
    total_supply: 122048136.08993804,
    infinite_supply: true,
    platform: null,
    cmc_rank: 2,
    self_reported_circulating_supply: null,
    self_reported_market_cap: null,
    tvl_ratio: null,
    last_updated: '2024-04-25T07:52:00.000Z',
    quote: {
      EUR: {
        price: 2931.406450237633,
        volume_24h: 13375601051.36901,
        volume_change_24h: 25.6828,
        percent_change_1h: -0.52028635,
        percent_change_24h: -3.57156717,
        percent_change_7d: 5.40947927,
        percent_change_30d: -14.06592805,
        percent_change_60d: 3.65573891,
        percent_change_90d: 42.82255861,
        market_cap: 357772693373.52484,
        market_cap_dominance: 16.2709,
        fully_diluted_market_cap: 357772693373.52783,
        tvl: null,
        last_updated: '2024-04-25T07:53:03.000Z',
      },
    },
  },
  {
    id: 825,
    name: 'Tether USDt',
    symbol: 'USDT',
    slug: 'tether',
    num_market_pairs: 84013,
    date_added: '2015-02-25T00:00:00.000Z',
    tags: [
      'payments',
      'stablecoin',
      'asset-backed-stablecoin',
      'avalanche-ecosystem',
      'solana-ecosystem',
      'arbitrum-ecosytem',
      'moonriver-ecosystem',
      'injective-ecosystem',
      'bnb-chain',
      'usd-stablecoin',
      'optimism-ecosystem',
    ],
    max_supply: null,
    circulating_supply: 110463515619.00531,
    total_supply: 112936550461.62344,
    platform: {
      id: 1027,
      name: 'Ethereum',
      symbol: 'ETH',
      slug: 'ethereum',
      token_address: '0xdac17f958d2ee523a2206206994597c13d831ec7',
    },
    infinite_supply: true,
    cmc_rank: 3,
    self_reported_circulating_supply: null,
    self_reported_market_cap: null,
    tvl_ratio: null,
    last_updated: '2024-04-25T07:52:00.000Z',
    quote: {
      EUR: {
        price: 0.932791124436202,
        volume_24h: 55471104747.11592,
        volume_change_24h: 14.0931,
        percent_change_1h: -0.00378709,
        percent_change_24h: -0.01759975,
        percent_change_7d: -0.04635359,
        percent_change_30d: -0.06409546,
        percent_change_60d: -0.03375633,
        percent_change_90d: 0.00604926,
        market_cap: 103039386943.42792,
        market_cap_dominance: 4.686,
        fully_diluted_market_cap: 105346211895.04779,
        tvl: null,
        last_updated: '2024-04-25T07:53:03.000Z',
      },
    },
  },
  {
    id: 1839,
    name: 'BNB',
    symbol: 'BNB',
    slug: 'bnb',
    num_market_pairs: 2151,
    date_added: '2017-07-25T00:00:00.000Z',
    tags: [
      'marketplace',
      'centralized-exchange',
      'payments',
      'smart-contracts',
      'alameda-research-portfolio',
      'multicoin-capital-portfolio',
      'bnb-chain',
      'layer-1',
      'sec-security-token',
      'alleged-sec-securities',
      'celsius-bankruptcy-estate',
    ],
    max_supply: null,
    circulating_supply: 147588281.96905267,
    total_supply: 147588281.96905267,
    infinite_supply: false,
    platform: null,
    cmc_rank: 4,
    self_reported_circulating_supply: null,
    self_reported_market_cap: null,
    tvl_ratio: null,
    last_updated: '2024-04-25T07:52:00.000Z',
    quote: {
      EUR: {
        price: 566.9804628685127,
        volume_24h: 1334365612.9310167,
        volume_change_24h: -0.3036,
        percent_change_1h: 0.03939192,
        percent_change_24h: -0.02199986,
        percent_change_7d: 11.44216882,
        percent_change_30d: 2.11534476,
        percent_change_60d: 59.41940989,
        percent_change_90d: 106.48946559,
        market_cap: 83679672424.78204,
        market_cap_dominance: 3.8023,
        fully_diluted_market_cap: 83679672424.78502,
        tvl: null,
        last_updated: '2024-04-25T07:53:03.000Z',
      },
    },
  },
  {
    id: 5426,
    name: 'Solana',
    symbol: 'SOL',
    slug: 'solana',
    num_market_pairs: 655,
    date_added: '2020-04-10T00:00:00.000Z',
    tags: [
      'pos',
      'platform',
      'solana-ecosystem',
      'cms-holdings-portfolio',
      'kenetic-capital-portfolio',
      'alameda-research-portfolio',
      'multicoin-capital-portfolio',
      'okx-ventures-portfolio',
      'layer-1',
      'ftx-bankruptcy-estate',
      'sec-security-token',
      'alleged-sec-securities',
      'cmc-crypto-awards-2024',
    ],
    max_supply: null,
    circulating_supply: 447040512.23116744,
    total_supply: 574597226.9919691,
    infinite_supply: true,
    platform: null,
    cmc_rank: 5,
    self_reported_circulating_supply: null,
    self_reported_market_cap: null,
    tvl_ratio: null,
    last_updated: '2024-04-25T07:52:00.000Z',
    quote: {
      EUR: {
        price: 136.59990156643127,
        volume_24h: 3596610430.6456885,
        volume_change_24h: 22.6813,
        percent_change_1h: -0.66607691,
        percent_change_24h: -7.50597052,
        percent_change_7d: 12.357515,
        percent_change_30d: -25.15679517,
        percent_change_60d: 42.08745042,
        percent_change_90d: 68.70364069,
        market_cap: 61065689966.98448,
        market_cap_dominance: 2.7748,
        fully_diluted_market_cap: 78489924647.45033,
        tvl: null,
        last_updated: '2024-04-25T07:53:03.000Z',
      },
    },
  },
];
